# Network Traffic Analysis - Quick Reference

## Commands

### Basic Network Analysis

```bash
# Monitor active network connections
python src/analyser/network_cli.py --monitor-connections --educational

# Discover available services
python src/analyser/network_cli.py --scan-services localhost --educational

# Capture and analyse network traffic
python src/analyser/network_cli.py --capture-traffic --duration 60 --educational

# DNS traffic analysis
python src/analyser/network_cli.py --dns-analysis --duration 30 --educational
```

### System Network Tools

```bash
# Display active connections
netstat -tuln                    # List all listening services
ss -tuln                        # Modern socket statistics
ss -tuln | grep LISTEN         # Filter for listening services only

# Network connectivity testing
ping -c 3 8.8.8.8              # Test basic connectivity
nslookup google.com            # DNS resolution test
dig @8.8.8.8 example.com      # DNS query with specific server
```

### Traffic Generation and Testing

```bash
# Generate sample network scenarios
python samples/network-scenarios/basic_activity.py

# Simulate suspicious network patterns
python samples/network-scenarios/suspicious_patterns.py

# Test DNS threat scenarios
python samples/network-scenarios/dns_threats.py
```

### Report Generation

```bash
# JSON reports for automation
python src/analyser/network_cli.py --monitor-connections --format json --output network_report.json

# Timestamped analysis reports
python src/analyser/network_cli.py --scan-services localhost > reports/network_$(date +%Y%m%d_%H%M).txt

# Educational analysis with explanations
python src/analyser/network_cli.py --demo-network --educational
```
## Concepts

### Network Traffic Analysis Fundamentals

**Network Monitoring**: Observing network communications to identify security threats
- Monitor connection patterns and data flows
- Identify unauthorized network access attempts
- Detect malicious communication patterns

**Service Discovery**: Identifying what services are running on network systems
- Map available network services and ports
- Understand attack surface and exposure
- Verify expected vs. actual service configurations

**Traffic Analysis**: Examining network communications for security indicators
- Analyse protocol usage and communication patterns
- Identify anomalous or suspicious network behaviour
- Correlate network activity with security events

### Network Security Principles

**Defence in Depth**: Multiple layers of network security controls
- Network segmentation and access controls
- Intrusion detection and prevention systems
- Traffic filtering and monitoring

**Secure Communication Protocols**: Protecting data in transit
- Encrypted protocols (HTTPS, SSH, SFTP)
- Certificate validation and trust management
- Secure network architecture design

### Threat Detection Methods

**Pattern Recognition**: Identifying known attack signatures
- Port scanning detection
- Brute force attempt identification
- Known malware communication patterns

**Anomaly Detection**: Identifying unusual network behaviour
- Unexpected service discovery
- Abnormal traffic volumes or timing
- Connections to suspicious destinations

**DNS Analysis**: Monitoring domain name system activity
- DNS tunneling detection
- Domain generation algorithm identification
- Malicious domain reputation checking

## Issues

### Common Network Analysis Problems

**No Network Activity Detected**:
```bash
# Fix: Generate test traffic for analysis
python samples/network-scenarios/basic_activity.py
curl http://localhost:5000  # Generate web traffic
```

**Tools Not Available**:
```bash
# Fix: Check tool availability and use alternatives
which netstat ss nslookup dig || echo "Using built-in analysis tools"
python src/analyser/network_cli.py --demo-network  # Use simulated data
```

**Permission Denied for Network Operations**:
```bash
# Fix: Use educational mode for simulated results
python src/analyser/network_cli.py --scan-services localhost --educational
```

### Analysis Interpretation Issues

**Too Much Network Noise**: Overwhelming amount of network activity
- Filter for specific protocols or services
- Focus on external connections vs. internal traffic
- Use time-based analysis to identify patterns

**False Positive Threats**: Normal network activity reported as suspicious
- Understand baseline network behaviour
- Consider legitimate business applications
- Cross-reference with application documentation

**Missing Context**: Network activity without understanding purpose
- Correlate with application logs and user activity
- Consider timing and frequency of connections
- Investigate source and destination context

### Environmental Limitations

**Containerized Network Environment**: Limited visibility in Docker environment
- Use educational mode for simulated comprehensive results
- Focus on container-to-container communication patterns
- Understand network isolation limitations

**No External Network Access**: Cannot perform real external reconnaissance
- Use provided sample scenarios for learning
- Focus on analysis methodology rather than live data
- Practice with simulated threat patterns

## üõ°Ô∏è Security Assessment Guidelines

### Risk Levels

- **CRITICAL**: Remote code execution, active backdoors, data exfiltration
- **HIGH**: Unencrypted services, vulnerable services exposed externally
- **MEDIUM**: Internal services with potential risks, missing security controls
- **LOW**: Informational findings, configuration recommendations

### Port Risk Assessment

```bash
# Critical Risk Ports
4444, 6666, 1337, 31337         # Common backdoor/malware ports
1234, 12345, 54321              # Trojan/backdoor ports

# High Risk Ports
21 (FTP), 23 (Telnet)          # Unencrypted protocols
135, 139, 445 (SMB)            # Windows file sharing
1433 (SQL Server), 3306 (MySQL) # Database services

# Medium Risk Ports
80 (HTTP)                       # Unencrypted web traffic
161 (SNMP)                      # Network management
2049 (NFS)                      # Network file system

# Generally Safe Ports
22 (SSH), 443 (HTTPS)          # Encrypted protocols
53 (DNS), 123 (NTP)            # Essential services
```

## üìä Common Analysis Workflows

### 1. Basic Network Assessment (15 minutes)

```bash
# Step 1: Check active connections
python src/analyser/network_cli.py --monitor-connections --educational


curl http://httpbin.org/get
ping -c 5 8.8.8.8

# Tools not available
# Solution: Use built-in alternatives
ss -tuln          # instead of netstat
python src/analyser/network_cli.py --scan-services localhost  # instead of nmap
```

### Performance Tips

```bash
# Limit output for large networks
netstat -tuln | head -20

# Use specific filters
python src/analyser/network_cli.py --capture-traffic --filter "port 80"

# Save output for later analysis
python src/analyser/network_cli.py --monitor-connections --format json --output analysis.json
```

## üì± Protocol Quick Reference

### TCP vs UDP

- **TCP**: Reliable, connection-oriented (web, email, file transfer)
- **UDP**: Fast, connectionless (DNS, video streaming, gaming)

### Common Protocol Ports

```
21    FTP          File Transfer Protocol
22    SSH          Secure Shell
23    Telnet       Remote Terminal
25    SMTP         Email sending
53    DNS          Domain Name System
80    HTTP         Web traffic
110   POP3         Email retrieval
143   IMAP         Email access
443   HTTPS        Secure web traffic
993   IMAPS        Secure email access
995   POP3S        Secure email retrieval
3389  RDP          Remote Desktop
5900  VNC          Virtual Network Computing
```

### Network Analysis Commands Summary

```bash
# Monitoring
netstat -tuln                   # Show all connections
ss -tuln                       # Modern connection display
lsof -i                        # Files/connections by process

# Testing
ping <host>                    # Connectivity test
nslookup <domain>              # DNS resolution
traceroute <host>              # Network path trace

# Analysis
python src/analyser/network_cli.py --help    # Full tool options
```

## üéì Educational Tips

### Learning Progression

1. **Start with localhost**: Understand your own system first
2. **Use educational mode**: Enable detailed explanations
3. **Compare methods**: Understand how network analysis differs from SAST/DAST
4. **Practice regularly**: Network patterns change, regular practice helps
5. **Document findings**: Good documentation is crucial for security work

### Best Practices

- Always establish a baseline before investigation
- Document everything with timestamps
- Use multiple tools to verify findings
- Understand false positives vs real threats
- Practice in safe, controlled environments

---

**Duration**: Reference for 3-4 hour exercises  
**Difficulty**: Intermediate  
**Prerequisites**: Basic networking knowledge  
**Tools**: network_cli.py, netstat, ss, nslookup, dig
