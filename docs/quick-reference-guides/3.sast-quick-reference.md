# SAST - Quick Reference

## Commands

### Basic Analysis Commands

```bash
# Analyze application with educational output (primary target)
python src/analyzer/analyze_cli.py samples/unsecure-pwa --educational

# Quick scan for critical vulnerabilities
python src/analyzer/analyze_cli.py samples/unsecure-pwa --quick

# Generate detailed JSON report
python src/analyzer/analyze_cli.py samples/unsecure-pwa --output report.json --format json

# Verbose output for debugging
python src/analyzer/analyze_cli.py samples/unsecure-pwa --verbose
```

### Tool-Specific Commands

```bash
# Bandit security linter (Python security issues)
bandit -r samples/unsecure-pwa/ -f json

# Safety dependency checker (known vulnerabilities)
safety check --file requirements.txt --json

# Semgrep static analysis (custom security rules)
semgrep --config=auto samples/unsecure-pwa/
```

### Report Generation

```bash
# Save analysis to timestamped file
python src/analyzer/analyze_cli.py target_app > reports/sast_$(date +%Y%m%d_%H%M).txt

# Generate executive summary
python src/analyzer/analyze_cli.py target_app --format summary

# Export findings for integration
python src/analyzer/analyze_cli.py target_app --format csv > findings.csv
## Concepts

### Static Application Security Testing (SAST)

**Source Code Analysis**: Examine application code without executing it
- Identifies vulnerabilities in source code
- Analyzes code patterns and structures
- Finds issues before deployment

**Key SAST Principles**:
- **Early Detection**: Find vulnerabilities during development
- **Comprehensive Coverage**: Analyze entire codebase systematically
- **Automated Scanning**: Use tools for consistent analysis
- **Developer Integration**: Embed security in development workflow

### Vulnerability Categories

**Injection Flaws**: Untrusted data sent to interpreters
- SQL injection, XSS, command injection
- Detected through input validation analysis

**Authentication Issues**: Weak authentication mechanisms
- Broken session management, weak passwords
- Found through authentication flow analysis

**Cryptographic Failures**: Weak encryption or hashing
- Hardcoded secrets, weak algorithms
- Identified through crypto usage patterns

**Access Control Problems**: Missing authorization checks
- Insecure direct object references
- Found through permission validation analysis

### Tool Capabilities

**Bandit**: Python-specific security linter
- Focuses on common Python security issues
- Checks for dangerous function usage
- Identifies configuration problems

**Semgrep**: Pattern-based static analysis
- Custom rule engine for complex patterns
- Framework-specific vulnerability detection
- Business logic flaw identification

**Safety**: Dependency vulnerability checker
- Scans for known CVEs in packages
- Identifies outdated dependencies
- Provides remediation guidance

## Issues

### Common Analysis Problems

**False Positives**: Tools report issues that aren't actual vulnerabilities
```bash
# Fix: Review findings manually and adjust tool configuration
python src/analyzer/analyze_cli.py target --confidence-level high
```

**Missing Dependencies**: Tools fail due to missing Python packages
```bash
# Fix: Install required packages
pip install bandit safety semgrep
```

**Permission Errors**: Cannot read certain files or directories
```bash
# Fix: Check file permissions and paths
ls -la target_directory/
chmod +r problematic_file
```

### Analysis Interpretation Issues

**Overwhelming Output**: Too many findings to process effectively
- Focus on Critical and High severity issues first
- Use `--quick` flag for initial assessment
- Filter by vulnerability type or file location

**Unclear Remediation**: Don't understand how to fix findings
- Use `--educational` flag for explanations
- Research specific vulnerability types
- Consult framework security documentation

**Tool Disagreements**: Different tools report conflicting results
- Cross-reference findings across multiple tools
- Prioritize based on confidence levels
- Validate findings manually when uncertain

3. Research additional context if needed

### Step 4: Remediation Planning

1. Prioritize fixes based on risk
2. Group related issues together
3. Plan implementation approach

### Step 5: Fix Implementation

1. Apply remediation techniques
2. Re-run analysis to verify fixes
3. Document changes made

## ðŸš¨ Common Vulnerability Patterns

### SQL Injection

```python
# Vulnerable
query = f"SELECT * FROM users WHERE id = {user_id}"

# Secure
query = "SELECT * FROM users WHERE id = ?"
cursor.execute(query, (user_id,))
```

### Cross-Site Scripting (XSS)

```python
# Vulnerable
return f"<p>Hello {user_input}</p>"

# Secure
from markupsafe import escape
return f"<p>Hello {escape(user_input)}</p>"
```

### Hardcoded Secrets

```python
# Vulnerable
API_KEY = "sk-1234567890abcdef"

# Secure
API_KEY = os.environ.get('API_KEY')
```

### Debug Mode in Production

```python
# Vulnerable
app.run(debug=True)

# Secure
app.run(debug=False)
```

## ðŸ“‹ Exercise Checklist

### Before Starting:

- [ ] Environment is set up and working
- [ ] Can run basic analysis commands
- [ ] Understand report structure
- [ ] Have worksheets ready

### During Analysis:

- [ ] Record findings systematically
- [ ] Understand vulnerability types
- [ ] Validate high-priority issues
- [ ] Document questions for discussion

### After Analysis:

- [ ] Complete remediation planning
- [ ] Verify fixes work
- [ ] Update documentation
- [ ] Reflect on learning

## ðŸ†˜ Troubleshooting

### Command Not Found

```bash
# Check if you're in the right directory
pwd
# Should show: /workspaces/Secure_Architecture_Sandbox_Testing_Environment

# Check if Python can find the module
python -c "import src.analyzer.analyze_cli"
```

### No Findings Reported

- Check if target path is correct
- Verify files exist in target directory
- Run with `--verbose` to see detailed output
- Check if security tools are installed

### Tool Errors

```bash
# Check tool availability
python -c "from src.analyzer.static_analyzer import SecurityToolRunner; print(SecurityToolRunner().check_available_tools())"

# Install missing tools if needed
pip install bandit safety semgrep
```

### Permission Errors

```bash
# Make sure CLI script is executable
chmod +x src/analyzer/analyze_cli.py

# Check file permissions
ls -la src/analyzer/
```

## ðŸŽ“ Key Learning Points

### Remember:

1. **SAST is one tool** in a comprehensive security strategy
2. **False positives happen** - always validate findings
3. **Context matters** - understand the business impact
4. **Fix systematically** - prioritize by risk, not by count
5. **Security is ongoing** - not a one-time activity

### Success Metrics:

- Can explain what SAST is and when to use it
- Can run analysis tools independently
- Can interpret and prioritize security findings
- Can apply basic remediation techniques
- Can communicate security issues effectively

---

**ðŸ’¡ Pro Tip**: Keep this reference handy during the exercises. The best way to
learn cybersecurity is by doing!
