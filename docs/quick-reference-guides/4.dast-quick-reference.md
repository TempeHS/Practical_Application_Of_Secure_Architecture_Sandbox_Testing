# DAST - Quick Reference

## Commands

### Basic Testing Commands

```bash
# Quick vulnerability scan
python src/analyser/dast_cli.py http://localhost:5000 --quick --educational --output quick_dast_scan.pdf --format pdf --verbose

# Educational mode with explanations (RECOMMENDED)
python src/analyser/dast_cli.py http://localhost:5000 --deep-scan --educational --output detailed_dast_unsecure_pwa.pdf --format pdf --verbose

# Comprehensive deep scan (RECOMMENDED)
python src/analyser/dast_cli.py http://localhost:5000 --deep-scan --tools all --educational --output comprehensive_dast_scan.pdf --format pdf --verbose

# Scan multiple applications
python src/analyser/dast_cli.py --demo-apps --deep-scan --educational --output demo_apps_dast_report.pdf --format pdf --verbose
```

### Tool-Specific Scans

```bash
# Nikto web vulnerability scanner
python src/analyser/dast_cli.py http://localhost:5000 --tools nikto

# Gobuster directory enumeration
python src/analyser/dast_cli.py http://localhost:5000 --tools gobuster

# Custom DAST probes (XSS, SQL injection)
python src/analyser/dast_cli.py http://localhost:5000 --tools custom

# All tools combined
python src/analyser/dast_cli.py http://localhost:5000 --tools all
```

### Report Generation

```bash
# JSON output for automation
python src/analyser/dast_cli.py http://localhost:5000 --output report.json

# Detailed text report
python src/analyser/dast_cli.py http://localhost:5000 --output report.txt --format txt

# Timestamped report
python src/analyser/dast_cli.py http://localhost:5000 > reports/dast_$(date +%Y%m%d_%H%M).txt
```

### Target Applications

```bash
# Unsecure PWA (primary target)
python src/analyser/dast_cli.py http://localhost:5000

# Vulnerable Flask application  
python src/analyser/dast_cli.py http://localhost:9090

# Student upload application
python src/analyser/dast_cli.py http://localhost:8000
```

## Concepts

### Dynamic Application Security Testing (DAST)

**Runtime Testing**: Analyse applications while they're running
- Tests from attacker's perspective (black-box testing)
- Sends malicious payloads to identify vulnerabilities
- Tests actual application behaviour and responses

**Key DAST Principles**:
- **Black-box Testing**: No source code access required
- **Real-world Conditions**: Tests live application
- **Attack Simulation**: Uses actual exploit techniques
- **Network-based Analysis**: Tests through application interfaces

### DAST vs SAST Comparison

| Aspect | SAST (Static) | DAST (Dynamic) |
|--------|---------------|----------------|
| **Analysis Method** | Source code examination | Running application testing |
| **Application State** | Not running | Must be running |
| **Detection Approach** | Pattern matching | Payload injection |
| **Coverage** | All code paths | Only accessible paths |
| **False Positives** | Higher | Lower |

### Vulnerability Detection Methods

**Payload Injection**: Send malicious inputs to test responses
- XSS payloads: `<script>alert('xss')</script>`
- SQL injection: `' OR 1=1--`
- Command injection: `; cat /etc/passwd`

**Header Analysis**: Examine HTTP security headers
- Missing security headers indicate vulnerabilities
- Improper configurations expose attack vectors
- Version disclosure reveals target information

**Directory Enumeration**: Discover hidden files and directories
- Administrative interfaces
- Backup files and configurations
- Development artefacts

### Tool Capabilities

**Nikto**: Comprehensive web vulnerability scanner
- Tests for thousands of known vulnerabilities
- Cheques server configurations and files
- Identifies outdated software versions

**Gobuster**: Directory and file enumeration
- Brute-force discovery of hidden resources
- Uses wordlists for comprehensive coverage
- Fast parallel scanning capabilities

**Custom Testing**: Application-specific vulnerability probes
- Framework-specific attack patterns
- Business logic testing
- Input validation bypass attempts

## Issues

### Common Testing Problems

**Application Not Accessible**:
```bash
# Fix: Ensure target application is running
curl http://localhost:5000 || echo "Application not responding"
docker-compose -f docker/docker-compose.yml up -d
```

**Network Connectivity Issues**:
```bash
# Fix: Check network configuration and firewall
ping localhost
netstat -tuln | grep 5000
```

**Tool Execution Failures**:
```bash
# Fix: Verify tool availability and permissions
which nikto gobuster || echo "External tools not available"
python --version  # Check Python environment
```

### Analysis Interpretation Issues

**False Positives**: Legitimate functionality reported as vulnerabilities
- Verify findings manually through browser testing
- Consider application context and intended behaviour
- Cross-reference with developer documentation

**Incomplete Coverage**: DAST may miss some vulnerabilities
- Limited to accessible application paths
- Cannot test business logic requiring specific user states
- May miss server-side vulnerabilities without visible responses

**Performance Impact**: Scanning may affect application performance
- Use `--quick` flag for lightweight testing
- Schedule comprehensive scans during off-hours
- Monitor application resources during testing

### Response Interpretation

**HTTP Status Codes**: Understand response meanings
- 200: Success (expected behaviour)
- 403: Forbidden (access control working)
- 500: Server error (potential vulnerability)
- 404: Not found (hidden resource discovery)

**Response Content**: Analyse application responses
- Error messages may reveal system information
- Debug output indicates development configurations
- Unexpected content suggests successful exploitation

docker-compose ps

# Start applications
cd docker && docker-compose up -d

# Verify connectivity
curl -I http://localhost:5000
curl -I http://localhost:9090
```

### DAST Scanner Issues:

```bash
# Check Python environment
python --version
pip list | grep requests

# Test with minimal command
python src/analyser/dast_cli.py http://localhost:5000 --quick

# Enable verbose logging
python src/analyser/dast_cli.py http://localhost:5000 --verbose
```

### Common Error Messages:

- **"Connection refused"**: Application not running
- **"Target URL is required"**: Missing URL parameter
- **"Invalid URL"**: URL must start with http:// or https://
- **"No findings"**: May be normal, try --deep-scan for more thorough testing

## ðŸŽ“ Educational Tips

### Understanding Results:

1. **Start with Summary**: Review total findings and severity distribution
2. **Focus on High Severity**: Address critical and high findings first
3. **Understand Detection**: Learn why each finding was classified as vulnerable
4. **Verify Manually**: Use browser tools to confirm findings

### Best Practices:

- Always run DAST against staging/test environments, never production
- Combine DAST with SAST for comprehensive coverage
- Regular scanning catches new vulnerabilities as code changes
- Document findings and track remediation progress

### Learning Path:

1. **Basic Concepts**: Understand HTTP, web applications, security basics
2. **Tool Usage**: Master command-line options and output interpretation
3. **Manual Verification**: Learn to validate findings using browser tools
4. **Remediation**: Understand how to fix identified vulnerabilities
5. **Integration**: Plan DAST into development workflows

## ðŸ“š OWASP Top 10 Mapping

| OWASP Category                    | DAST Detection              | Tools Used           |
| --------------------------------- | --------------------------- | -------------------- |
| A01 - Broken Access Control       | Authentication testing      | Custom tests         |
| A02 - Cryptographic Failures      | HTTPS analysis              | Header analyser      |
| A03 - Injection                   | SQL injection, XSS testing  | Vulnerability tester |
| A04 - Insecure Design             | Manual analysis needed      | N/A                  |
| A05 - Security Misconfiguration   | Missing headers, debug info | Header analyser      |
| A06 - Vulnerable Components       | Limited detection           | Basic reconnaissance |
| A07 - Authentication Failures     | Login bypass testing        | Custom tests         |
| A08 - Software Integrity Failures | Limited detection           | N/A                  |
| A09 - Security Logging Failures   | Limited detection           | N/A                  |
| A10 - Server-Side Request Forgery | SSRF testing                | Custom tests         |

## ðŸ”— Useful Resources

### Official Documentation:

- OWASP Testing Guide: https://owasp.org/www-project-web-security-testing-guide/
- OWASP ASVS:
  https://owasp.org/www-project-application-security-verification-standard/

### Tools:

- OWASP ZAP: https://www.zaproxy.org/
- Burp Suite: https://portswigger.net/burp
- Nikto: https://cirt.net/Nikto2

### Learning:

- PortSwigger Web Security Academy: https://portswigger.net/web-security
- OWASP WebGoat: https://owasp.org/www-project-webgoat/

---

**ðŸ’¡ Remember**: DAST is most effective when applications are running in a
realistic test environment. Always combine with other testing methods for
comprehensive security coverage!
