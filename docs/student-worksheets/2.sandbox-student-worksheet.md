# Sandbox Security Analysis - Student Worksheet

**Name:** _________________ **Date:** _________

**Lab Partner:** _________________ **Section:** _________

## Activities

### Activity 1: Sandbox Environment Setup

Verify your sandbox environment is ready:

```bash
# Enter sandbox container
docker exec -it cybersec_sandbox bash

# Check available monitoring tools
which strace netstat top lsof
```

**Environment Checklist:**
- [ ] Successfully entered sandbox container
- [ ] System monitoring tools available
- [ ] Sample applications accessible

### Activity 2: System Call Monitoring

Analyze suspicious script behavior using system call tracing:

```bash
# Run suspicious script with monitoring
strace -o trace.log python samples/suspicious-scripts/fake_game.py

# Review system calls
cat trace.log | head -20
```

**System Call Analysis:**
1. What files does the script access? _________________
2. What network connections are made? _________________
3. What system calls look suspicious? _________________

### Activity 3: Network Activity Monitoring

Monitor network behavior of suspicious applications:

```bash
# Monitor network connections
netstat -tulpn | grep python

# Check for listening services
ss -tuln | grep LISTEN
```

**Network Activity:**
1. What ports are opened? _________________
2. Are there unexpected network connections? _________________
3. What network behavior is suspicious? _________________

### Activity 4: Resource Usage Analysis

Examine resource consumption patterns:

```bash
# Monitor resource usage
top -p $(pgrep python)

# Check memory usage
ps aux | grep python | head -5
```

**Resource Analysis:**
1. What is the CPU usage pattern? _________________
2. How much memory is consumed? _________________
3. Are there signs of resource abuse? _________________

## Questions

### Technical Understanding

**1. System Call Analysis:**
Explain what system calls revealed about the suspicious applications:
_________________________________________________________________
_________________________________________________________________

**2. Network Behavior:**
Describe any suspicious network activity you observed:
_________________________________________________________________
_________________________________________________________________

**3. Resource Usage:**
What resource consumption patterns indicated malicious behavior?
_________________________________________________________________
_________________________________________________________________

**4. Containment Effectiveness:**
How did the sandbox environment protect the host system?
_________________________________________________________________
_________________________________________________________________

### Security Assessment

**5. Threat Classification:**
Classify the threats you identified (malware, spyware, trojans, etc.):
_________________________________________________________________
_________________________________________________________________

**6. Attack Vectors:**
How might these threats reach real systems in an organization?
_________________________________________________________________
_________________________________________________________________

**7. Impact Analysis:**
What damage could these threats cause in a real environment?
_________________________________________________________________
_________________________________________________________________

### Methodology Evaluation

**8. Sandbox Limitations:**
What are the limitations of sandbox analysis?
_________________________________________________________________
_________________________________________________________________

**9. Detection Evasion:**
How might sophisticated malware evade sandbox detection?
_________________________________________________________________
_________________________________________________________________

## Reflection

### Learning Insights

**What was the most concerning behavior you observed?**
_________________________________________________________________
_________________________________________________________________

**How does sandbox analysis complement other security testing methods?**
_________________________________________________________________
_________________________________________________________________

**What skills are needed to effectively analyze suspicious applications?**
_________________________________________________________________
_________________________________________________________________

### Practical Application

**How would you implement sandbox analysis in an organization?**
_________________________________________________________________
_________________________________________________________________

**What processes should be in place for handling suspicious files?**
_________________________________________________________________
_________________________________________________________________

**How can organizations train employees about malware threats?**
_________________________________________________________________
_________________________________________________________________
computer?

---

---

**Question**: How could sandbox analysis help you safely determine if this file
is malicious?

---

---

---

## üîç Network Architecture Exploration Exercise

**Task**: Explore our containerized security architecture hands-on

### Step 1: Access Your Security Workstation

1. **Enter the security analyst container**:
   ```bash
   docker exec -it cybersec_sandbox bash
   ```

2. **Verify your network identity**:
   ```bash
   hostname -I
   ```

**Your Container IP Address**: **\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_**

### Step 2: Network Discovery

3. **Discover all containers in the sandbox network**:
   ```bash
   nmap -sn 172.20.0.0/16
   ```

**Container Discovery Results**: List all IP addresses found:

- **\_\_\_\_\_\_\_\_\_\_\_\_\_\_** - (This is your security workstation)
- **\_\_\_\_\_\_\_\_\_\_\_\_\_\_** - Target container 1
- **\_\_\_\_\_\_\_\_\_\_\_\_\_\_** - Target container 2  
- **\_\_\_\_\_\_\_\_\_\_\_\_\_\_** - Target container 3
- **\_\_\_\_\_\_\_\_\_\_\_\_\_\_** - Target container 4

### Step 3: Service Discovery

4. **Scan for running services on target containers**:
   ```bash
   nmap -sV 172.20.0.3-6
   ```

**Service Discovery Results**: Fill in what you found:

| Container IP | Port | Service | Application Type |
|-------------|------|---------|------------------|
| 172.20.0.3  | **\_\_\_\_** | **\_\_\_\_\_\_\_\_\_\_** | **\_\_\_\_\_\_\_\_\_\_\_\_\_\_** |
| 172.20.0.4  | **\_\_\_\_** | **\_\_\_\_\_\_\_\_\_\_** | **\_\_\_\_\_\_\_\_\_\_\_\_\_\_** |
| 172.20.0.5  | **\_\_\_\_** | **\_\_\_\_\_\_\_\_\_\_** | **\_\_\_\_\_\_\_\_\_\_\_\_\_\_** |
| 172.20.0.6  | **\_\_\_\_** | **\_\_\_\_\_\_\_\_\_\_** | **\_\_\_\_\_\_\_\_\_\_\_\_\_\_** |

### Step 4: Architecture Understanding

5. **Network Isolation Test**: Try to reach the internet from inside the container:
   ```bash
   ping google.com
   curl https://google.com
   ```

**Results**: Can you reach external websites? **YES / NO**

**Why is this important for security?**

---

---

### Step 5: Target Application Access

6. **Test connectivity to target applications**:
   ```bash
   curl http://172.20.0.3:3000
   curl http://172.20.0.4:5000  
   curl http://172.20.0.5:8000
   curl http://172.20.0.6:9090
   ```

**Application Response Summary**: Which applications responded successfully?

- **172.20.0.3:3000**: **Responded / No Response**
- **172.20.0.4:5000**: **Responded / No Response**  
- **172.20.0.5:8000**: **Responded / No Response**
- **172.20.0.6:9090**: **Responded / No Response**

### Architecture Reflection

**Question**: How does this network architecture provide security for malware analysis?

---

---

**Question**: What would happen if malware tried to "phone home" to an external server?

---

---

## üß™ Exercise 1: Basic Behavioral Analysis

### Setup Phase

**Task**: Set up monitoring for the suspicious Python script

1. **Enter the sandbox environment**:

   ```bash
   Command to run: _________________________________________
   ```

2. **Navigate to the analysis workspace**:

   ```bash
   Command to run: _________________________________________
   ```

3. **Examine the script safely** (without running it):
   ```bash
   Command to run: _________________________________________
   ```

**Initial Observations**: What does the script claim to do?
**\_\_\_\_****\_\*\*\_\_**** Do you notice any suspicious imports or functions?
**\_**\_\*\*\_\_**\*\*

---

### Monitoring Setup

4. **Set up system call tracing**:

   ```bash
   Command to run: _________________________________________
   ```

5. **Record baseline network state**:
   ```bash
   Command to run: _________________________________________
   ```

### Analysis Phase

6. **Execute the script under monitoring** and let it run for 30 seconds

7. **Analyze system calls for file operations**:
   ```bash
   Command to run: _________________________________________
   ```

**File Access Findings**: What files did the script try to access?
**\_\_\_\_****\_\*\*\_\_**\*\*

---

Are any of these concerning? Why? **\_\_\_\_**\_\_\_\_\*\*

---

8. **Analyze system calls for network operations**:
   ```bash
   Command to run: _________________________________________
   ```

**Network Activity Findings**: What network connections did the script attempt?
**\_\_\_\_**\_\_\_\_\*\*

---

What data might have been transmitted? **\_\_\_\_**\_\_\_\_\*\*

### Risk Assessment

**Question**: Based on your analysis, is this script malicious? Explain your
reasoning:

---

---

**Question**: What potential damage could this script cause if run on a real
system?

---

---

## üåê Exercise 2: Web Application Backdoor Detection

### Discovery Phase

**Task**: Find hidden functionality in the web application

1. **Test normal web pages**:

   ```bash
   URLs tested:
   - http://localhost:5000/ : _______________________________________________
   - http://localhost:5000/about : _________________________________________
   - http://localhost:5000/contact : _______________________________________
   ```

2. **Use directory enumeration to find hidden endpoints**:
   ```bash
   Command to run: _________________________________________
   ```

**Hidden Endpoints Discovered**: List any suspicious or hidden URLs you found:

- ***
- ***
- ***

### Backdoor Analysis

3. **Test the hidden endpoints**:

   ```bash
   Command 1: ______________________________________________________________
   Result: _________________________________________________________________

   Command 2: ______________________________________________________________
   Result: _________________________________________________________________
   ```

**Backdoor Capabilities**: What can an attacker do through these hidden
endpoints?

---

---

### Security Impact Assessment

**Risk Level** (Circle one): LOW MEDIUM HIGH CRITICAL

**Justification**: Why did you choose this risk level?

---

---

**Potential Impact**: What could an attacker accomplish with this backdoor?

---

---

## ‚ö° Exercise 3: Resource Abuse Detection

### Baseline Measurement

**Task**: Detect applications that abuse system resources

1. **Record initial system state**:
   ```bash
   Commands to run:
   - CPU usage: ____________________________________________________________
   - Memory usage: _________________________________________________________
   ```

**Baseline Measurements**:

- Current CPU usage: **\_\_**%
- Available memory: **\_\_\_\_**\_**\_\_\_\_**
- Number of running processes: **\_\_\_\_**\_**\_\_\_\_**

### Resource Monitoring

2. **Start the suspicious "maintenance tool"**:

   ```bash
   Command to run: _________________________________________
   ```

3. **Monitor resource consumption for 60 seconds**:
   ```bash
   Commands to run every 10 seconds:
   - ____________________________________________________________________
   - ____________________________________________________________________
   ```

**Resource Consumption Observations**: Fill in the monitoring data:

| Time (seconds) | CPU Usage (%) | Memory Usage | Suspicious Activity        |
| -------------- | ------------- | ------------ | -------------------------- |
| 0 (baseline)   | **\_**        | **\_**       | **\_\_\_\_**\_**\_\_\_\_** |
| 10             | **\_**        | **\_**       | **\_\_\_\_**\_**\_\_\_\_** |
| 20             | **\_**        | **\_**       | **\_\_\_\_**\_**\_\_\_\_** |
| 30             | **\_**        | **\_**       | **\_\_\_\_**\_**\_\_\_\_** |
| 40             | **\_**        | **\_**       | **\_\_\_\_**\_**\_\_\_\_** |
| 50             | **\_**        | **\_**       | **\_\_\_\_**\_**\_\_\_\_** |
| 60             | **\_**        | **\_**       | **\_\_\_\_**\_**\_\_\_\_** |

### Network Activity Analysis

4. **Check for suspicious network connections**:
   ```bash
   Command to run: _________________________________________
   ```

**Network Findings**: What external servers is the application trying to connect
to?

---

---

Why might these connections be suspicious?

---

---

### Behavioral Pattern Analysis

**Question**: What type of malicious software does this behavior pattern
suggest?

---

**Question**: How could you confirm your suspicion?

---

---

## üìä Synthesis and Reflection

### Threat Summary

Complete the threat analysis table:

| Application       | Threat Type                  | Risk Level                   | Key Evidence             | Recommended Action         |
| ----------------- | ---------------------------- | ---------------------------- | ------------------------ | -------------------------- |
| Suspicious Script | **\_\_\_\_****\*\*\_\_**\*\* | **\_\_\_\_****\*\*\_\_**\*\* | **\_\_\_\_**\_\_\_\_\*\* | **\_\_\_\_**\_**\_\_\_\_** |
| Backdoor Web App  | **\_\_\_\_****\*\*\_\_**\*\* | **\_\_\_\_****\*\*\_\_**\*\* | **\_\_\_\_**\_\_\_\_\*\* | **\_\_\_\_**\_**\_\_\_\_** |
| Resource Abuser   | **\_\_\_\_****\*\*\_\_**\*\* | **\_\_\_\_****\*\*\_\_**\*\* | **\_\_\_\_**\_\_\_\_\*\* | **\_\_\_\_**\_**\_\_\_\_** |

### Critical Thinking Questions

1. **Detection Evasion**: How might malicious software try to avoid detection in
   sandbox environments?

   ***

   ***

2. **Real-World Application**: In what professional situations would sandbox
   analysis be most valuable?

   ***

   ***

3. **Limitations**: What are the limitations of sandbox analysis? What might it
   miss?

   ***

   ***

4. **Defense Strategy**: Based on today's exercise, what defensive measures
   would you recommend for an organization?
   ***
   ***

### Tool Mastery Checklist

Check off the tools and techniques you've successfully used:

**System Monitoring**:

- [ ] `strace` - System call tracing
- [ ] `netstat` - Network connection monitoring
- [ ] `top`/`htop` - Resource usage monitoring
- [ ] `lsof` - File access monitoring

**Analysis Techniques**:

- [ ] Baseline establishment
- [ ] Behavioral pattern recognition
- [ ] Evidence collection and documentation
- [ ] Risk assessment and classification

**Security Concepts**:

- [ ] Sandbox isolation principles
- [ ] Malicious behavior indicators
- [ ] Network traffic analysis
- [ ] Resource abuse detection

## üèÜ Challenge Questions (Optional)

### Advanced Analysis

**Challenge 1**: Research a real-world malware family (e.g., Zeus, Conficker,
WannaCry). How would sandbox analysis help identify its malicious behavior?

---

---

**Challenge 2**: Design a theoretical malware that could evade the detection
techniques we used today. What would it do differently?

---

---

### Career Connection

**Challenge 3**: Research the role of a "Malware Analyst" or "Incident Response
Specialist." How do they use sandbox analysis in their daily work?

---

---

## üìù Self-Assessment

Rate your confidence level (1-5, where 5 = very confident):

- Understanding sandbox analysis concepts: **\_**/5
- Setting up monitoring environments: **\_**/5
- Identifying malicious behavior patterns: **\_**/5
- Using command-line analysis tools: **\_**/5
- Documenting security findings: **\_**/5

**What was the most challenging part of this exercise?**

---

---

**What was the most interesting discovery you made?**

---

---

**What would you like to learn more about?**

---

---

---

## ‚öñÔ∏è Legal and Ethical Considerations

### Professional Responsibility in Malware Analysis

**1. Employment Impact:** How do malware incidents affect IT security teams and
organizational employment?

---

---

**2. Privacy Rights:** What privacy concerns arise when analyzing applications
that may access personal data?

---

---

**3. Intellectual Property:** How could malware expose or steal proprietary
software and trade secrets?

---

---

### Legal Framework for Security Analysis

**4. Authorized Analysis:** Why is it critical to only analyze suspicious
software in controlled, authorized environments?

---

---

**5. Evidence Handling:** What legal requirements apply to documenting and
preserving malware analysis evidence?

---

---

### Ethical Malware Research

**6. Responsible Disclosure:** How should security researchers ethically handle
discovery of new malware families?

---

---

**7. Professional Standards:** What ethical obligations do cybersecurity
analysts have when conducting malware analysis?

---

---

---

## üîê Cryptography and Sandbox Security

### Cryptographic Analysis in Sandboxing

**1. Encryption Assessment:** Did any analyzed applications use encryption to
hide malicious activities?

---

---

**2. Communication Security:** How did malicious applications handle
cryptographic protection of network communications?

---

---

**3. Key Management:** What cryptographic vulnerabilities were exposed in the
malicious applications?

---

---

**4. Sandbox Cryptography:** How does cryptography contribute to secure sandbox
design and operation?

---

---

---

## üíº Business Impact Assessment

### Enterprise Malware Impact Analysis

**1. Operational Disruption:** How would the malware behaviors you observed
affect business operations?

---

---

**2. Financial Impact:** Estimate the potential business costs of the threats
you analyzed:

- **Data Loss Costs:** **\_\_\_\_****\_\*\*\_\_**\*\*
- **System Recovery Costs:** **\_\_\_\_**\_\_\_\_\*\*
- **Regulatory Penalties:** **\_\_\_\_**\_\_\_\_\*\*
- **Business Interruption:** **\_\_\_\_**

**3. Reputation Damage:** How could malware incidents affect organizational
reputation and customer trust?

---

---

**4. Incident Response:** What would be the cost and complexity of responding to
the threats you analyzed?

---

---

---

**Completed by**: **\_\_\_\_**\_**\_\*\* **Date**: \*\*\_\_****\_\_\_\_**  
**Instructor Review**: **\_\_\_\_**\_**\_\*\* **Grade**: \*\*\_\_**\*\*
