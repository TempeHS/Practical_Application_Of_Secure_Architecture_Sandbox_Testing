# Network Traffic Analysis Exercise

## üìñ Overview

Network Traffic Analysis is a cybersecurity technique that monitors, captures, and analyzes network communications to detect security threats, unauthorized access, and malicious activities. It focuses on communication patterns and data flows between systems.

**Think of it this way:** If your computer network is like a building, network traffic analysis is like being a security guard who watches all the doors and windows to see who comes in, who goes out, and what they're carrying.

**This exercise aligns with these syllabus points:**
- **6.1.2 Analyze security requirements** - Monitor network communications for security compliance
- **6.1.3 Analyze network security components** - Examine network protocols and traffic patterns  
- **6.2.1 Implement secure network architecture** - Understanding network traffic helps design secure systems
- **6.2.2 Implement secure protocols** - Analyze how protocols behave and identify weaknesses

## üéØ Prerequisites

### Technical Requirements
- Basic understanding of computer networks and TCP/IP
- Familiarity with command line interface
- Understanding of ports and network protocols

### Environment Setup
**Navigate to main folder:**
```bash
cd /workspaces/Secure_Architecture_Sandbox_Testing_Environment
```

**Test the network analysis tool:**
```bash
python src/analyzer/network_cli.py --help
```

**Verify system network tools:**
```bash
which netstat && echo "‚úÖ netstat available" || echo "‚ùå netstat missing"
```

## üìã Activities

### Activity 1: Monitor Network Connections

**Objective:** Monitor active network connections to identify potentially suspicious communication patterns.

**Step 1: Check Current Connections**
```bash
cd /workspaces/Secure_Architecture_Sandbox_Testing_Environment
python src/analyzer/network_cli.py --monitor-connections --educational
```

**Expected Output:**
```
üåê NETWORK CONNECTION MONITORING
ACTIVE CONNECTIONS:
  localhost:5000 (PWA App) - Status: LISTENING
  localhost:9090 (Flask App) - Status: LISTENING
  localhost:22 (SSH) - Status: LISTENING
```

**Also try manual approach:**
```bash
netstat -tuln | head -20
```

**What to Look For:**
- **LISTEN**: Service waiting for connections (normal)
- **Port 22**: SSH (secure remote access)
- **Port 5000**: Our PWA application (primary target)
- **Port 9090**: Our Flask application

**Step 2: Identify Suspicious Activity**
```bash
# Check for connections to unusual ports
netstat -tuln | grep -E ":4444|:6666|:1337|:31337"
```

**Expected:** No output (these are malicious ports that shouldn't be in use)

**If you see output:** Could indicate backdoor/malware activity

**Step 3: Analyze Connection Patterns**
```bash
# Look for excessive connections from single IPs
netstat -tuln | awk '{print $5}' | cut -d: -f1 | sort | uniq -c | sort -nr
```

### Activity 2: Discover Network Services

**Objective:** Discover network services and assess their security implications.

**Step 1: Scan Local Services**
```bash
python src/analyzer/network_cli.py --scan-services localhost --educational --verbose
```

**Step 2: Check for High-Risk Services**
```bash
# Look for potentially risky services
netstat -tuln | grep -E ":21|:23|:3389|:5900"
```

**What These Ports Mean:**
- **Port 21**: FTP (file transfer, often insecure)
- **Port 23**: Telnet (unencrypted remote access)
- **Port 3389**: Remote Desktop (potential attack vector)
- **Port 5900**: VNC (remote desktop, often unencrypted)

**Step 3: Examine Service Security**
```bash
# Generate detailed service report
python src/analyzer/network_cli.py --scan-services localhost --format json --output service_scan.json
```

### Activity 3: Analyze Traffic Patterns

**Objective:** Analyze network traffic patterns to identify potential security threats.

**Step 1: Start Traffic Monitoring**
```bash
python src/analyzer/network_cli.py --capture-traffic --duration 30 --educational
```

**Step 2: Generate Network Activity**
```bash
# In another terminal, generate network activity
curl http://httpbin.org/get
curl http://httpbin.org/post -d "test=data"
ping -c 5 8.8.8.8
```

**Step 3: Analyze Results**
```bash
python src/analyzer/network_cli.py --capture-traffic --duration 60 --format json --output traffic_analysis.json --educational
```

**Look For:**
- HTTP requests to legitimate servers
- DNS resolution activity
- Failed connection attempts
- Protocol usage patterns

### Activity 4: Monitor DNS Traffic

**Objective:** Monitor DNS queries to detect malicious domain communication.

**Step 1: Start DNS Monitoring**
```bash
python src/analyzer/network_cli.py --dns-analysis --duration 30 --educational
```

**Step 2: Generate DNS Queries**
```bash
# Generate legitimate DNS queries
nslookup google.com
nslookup github.com
dig @8.8.8.8 stackoverflow.com
```

**Step 3: Analyze DNS Patterns**
```bash
python src/analyzer/network_cli.py --dns-analysis --duration 60 --format json --educational --output dns_analysis.json
```

**Watch For:**
- Normal DNS resolution patterns
- Suspicious domain queries
- DNS query frequency patterns
- Potential DNS tunneling indicators

### Activity 5: Investigate Security Scenario

**Scenario:** Multiple internal systems are making connections to an external IP on port 4444, with increased DNS queries to suspicious domains.

**Your Investigation Steps:**
1. Use network monitoring tools to investigate
2. Check for connections to port 4444
3. Monitor DNS queries for suspicious patterns
4. Document findings with evidence

**Investigation Commands:**
```bash
# Check for port 4444 connections
netstat -tuln | grep 4444

# Monitor for suspicious DNS activity
python src/analyzer/network_cli.py --dns-analysis --duration 120 --educational

# Generate comprehensive network report
python src/analyzer/network_cli.py --monitor-connections --capture-traffic --dns-analysis --format json --educational
```

## üìù Summary

### Key Concepts Learned
- **Network Traffic Analysis**: Monitoring and analyzing network communications to detect security threats
- **Connection Monitoring**: Identifying active network connections and suspicious patterns
- **Service Discovery**: Finding network services and assessing their security implications
- **Traffic Pattern Analysis**: Examining network traffic for signs of malicious activity
- **DNS Analysis**: Monitoring DNS queries for suspicious domain communication

### Critical Security Indicators
- **Suspicious Ports**: Connections to ports 1337, 4444, 6666 often indicate malware
- **Excessive Connections**: Multiple connections from single IPs may indicate attacks
- **Unusual Services**: Insecure services like Telnet (port 23) or unencrypted FTP (port 21)
- **DNS Anomalies**: Queries to suspicious domains or DNS tunneling patterns

### Network Security Tools
- **network_cli.py**: Educational network analysis tool with safety features
- **netstat/ss**: Display network connections and statistics
- **nslookup/dig**: DNS query tools for investigating domain resolution

### Real-World Applications
Network traffic analysis is essential for:
- Security Operations Centers (SOCs) monitoring network threats
- Incident response investigations
- Detecting advanced persistent threats (APTs)
- Compliance monitoring and network security auditing

## üéØ Real-World Applications

### Industry Use Cases

- **Security Operations Centers (SOCs)**: 24/7 network monitoring and threat
  detection
- **Incident Response**: Investigating and containing network-based attacks
- **Compliance Auditing**: Ensuring network communications meet regulatory
  requirements
- **Threat Hunting**: Proactively searching for advanced persistent threats

### Career Connections

- **Network Security Analyst**: Monitors and analyzes network traffic for
  threats
- **SOC Analyst**: Operates security monitoring tools and responds to alerts
- **Incident Response Specialist**: Investigates and contains security breaches
- **Penetration Tester**: Uses network analysis to identify vulnerabilities

## üìö Additional Resources

### Advanced Tools for Further Learning

- **Wireshark**: Comprehensive packet analysis and network protocol analyzer
- **Zeek (formerly Bro)**: Network security monitoring framework
- **Suricata**: Intrusion detection system with network monitoring
- **ntopng**: Web-based network traffic monitoring

### Reference Materials

- NIST Cybersecurity Framework - Network Security Guidelines
- MITRE ATT&CK Framework - Network-based Tactics and Techniques
- "Network Security Monitoring" by Richard Bejtlich
- "Applied Network Security Monitoring" by Hjelmvik & Sanders

### Next Steps

1. Learn advanced packet analysis with Wireshark
2. Study network protocols in depth (TCP/IP, HTTP, DNS)
3. Explore machine learning approaches to network anomaly detection
4. Practice with capture-the-flag (CTF) network challenges

---

**Duration**: 3-4 hours  
**Difficulty**: Intermediate  
**Prerequisites**: Basic networking knowledge and command line skills  
**Tools Required**: Network analysis CLI, netstat, ss, basic network utilities
