# Sandbox Security Analysis - Student Worksheet Answer Sheet

**Instructor Guide and Answer Key**

---

## üîß Pre-Exercise Setup Verification - Expected Responses

### Step 1: Check Docker Environment

**Expected Output**: Students should see both containers with "Up" status

```
cybersec_sandbox     Up
vulnerable_web_app   Up
```

### Step 2-4: Tool and Application Verification

**Expected Results**: All checkboxes should be marked as completed (‚úÖ)
**Teaching Note**: If any verification fails, guide students through
troubleshooting steps

---

## üéØ Learning Objectives - Assessment Criteria

Students should demonstrate understanding of:

- [ ] Sandbox analysis vs SAST/DAST differences (isolation and safe execution)
- [ ] Setting up secure analysis environments (container isolation)
- [ ] System monitoring techniques (strace, netstat, htop)
- [ ] Malicious behavior pattern recognition (network, file, resource abuse)
- [ ] Professional security documentation standards
- [ ] **NEW**: Containerized security architecture and multi-layer isolation

---

## üèóÔ∏è Network Architecture Analysis - Answer Key

### Container Identification - Expected Answers

- Security Tools Container: **cybersec_sandbox_tools** (IP: **172.20.0.2**)
- Target Container 1: **vulnerable-nodejs** (IP: **172.20.0.3**)
- Target Container 2: **unsecure-pwa** (IP: **172.20.0.4**)
- Target Container 3: **student-uploads** (IP: **172.20.0.5**)
- Target Container 4: **vulnerable-flask** (IP: **172.20.0.6**)

### Network Isolation - Expected Answer

**Network Range**: **172.20.0.0/16**

### Security Boundaries - Expected Answers

- Layer 1: **Physical isolation (student computer ‚Üí Codespaces cloud)**
- Layer 2: **Network isolation (private 172.20.0.0/16 subnet with no internet access)**
- Layer 3: **Container isolation (separate containers with resource limits)**
- Layer 4: **Application monitoring (system call tracing and behavioral analysis)**

### Professional Connection - Expected Answer

This architecture mirrors real-world cybersecurity environments by implementing:
- **Malware analysis labs** that use similar multi-layer isolation
- **Incident response environments** for safe threat investigation
- **Penetration testing networks** with controlled target systems
- **Security research facilities** that study threats without risk
- **Enterprise DMZ architectures** with network segmentation

---

## üîç Network Architecture Exploration - Answer Key

### Network Discovery Results - Expected Answers

**Container Discovery Results**:
- **172.20.0.2** - Security workstation (cybersec_sandbox_tools)
- **172.20.0.3** - vulnerable-nodejs container
- **172.20.0.4** - unsecure-pwa container
- **172.20.0.5** - student-uploads container
- **172.20.0.6** - vulnerable-flask container

### Service Discovery Results - Expected Answers

| Container IP | Port | Service | Application Type |
|-------------|------|---------|------------------|
| 172.20.0.3  | **3000** | **HTTP/Node.js** | **Vulnerable Node.js web app** |
| 172.20.0.4  | **5000** | **HTTP/Flask** | **Insecure Progressive Web App** |
| 172.20.0.5  | **8000** | **HTTP/Python** | **File upload testing app** |
| 172.20.0.6  | **9090** | **HTTP/Flask** | **Vulnerable Flask with backdoors** |

### Network Isolation Test - Expected Results

**Results**: Can you reach external websites? **NO**

**Why is this important for security?**
- Prevents malware from downloading additional payloads
- Stops data exfiltration to external command & control servers
- Ensures malware cannot "phone home" or receive updates
- Protects against network-based attacks spreading beyond sandbox
- Maintains complete isolation for safe analysis

### Application Response Summary - Expected Answers

- **172.20.0.3:3000**: **Responded** (Node.js application)
- **172.20.0.4:5000**: **Responded** (PWA application)
- **172.20.0.5:8000**: **Responded** (Upload service)
- **172.20.0.6:9090**: **Responded** (Flask application)

### Architecture Reflection - Expected Answers

**Question**: How does this network architecture provide security for malware analysis?

**Expected Answer**: The multi-layer architecture provides security through:
- Complete isolation from external networks prevents malware communication
- Container boundaries prevent malware from escaping to host system
- Network segmentation limits lateral movement between containers
- Resource controls prevent system abuse and denial of service
- Monitoring capabilities detect and log all malicious activities
- Disposable containers can be destroyed and recreated if compromised

**Question**: What would happen if malware tried to "phone home" to an external server?

**Expected Answer**: The network connection would fail because:
- Containers have no internet access outside the sandbox network
- DNS queries to external domains would be blocked
- TCP/UDP connections to external IPs would be rejected
- This isolation prevents command & control communication
- Malware cannot download additional payloads or receive instructions
- Data exfiltration attempts would be blocked at the network level

---

## üìö Pre-Exercise Knowledge Check - Answer Key

### 1. Security Testing Methods Comparison

| Method  | What it analyzes         | When it runs           | Safety level           |
| ------- | ------------------------ | ---------------------- | ---------------------- |
| SAST    | **Source code**          | **Development time**   | **Very safe**          |
| DAST    | **Running applications** | **Runtime/testing**    | **Moderately safe**    |
| Sandbox | **Application behavior** | **Controlled runtime** | **Safest for malware** |

**Teaching Points**:

- SAST: Analyzes code without execution, completely safe
- DAST: Tests running apps, requires caution with production systems
- Sandbox: Safest for analyzing potentially malicious software

### 2. Risk Scenarios

**Question**: What are the potential risks of running "System Performance
Booster.exe" directly? **Expected Answer**:

- Could be malware disguised as legitimate software
- May steal personal data, passwords, or financial information
- Could install backdoors or ransomware
- Might damage or corrupt system files
- Could turn computer into part of a botnet

**Question**: How could sandbox analysis help safely determine if this file is
malicious? **Expected Answer**:

- Isolated environment prevents damage to real system
- Monitor all file access, network connections, and system changes
- Observe actual behavior vs claimed functionality
- Safely test without risking production systems
- Document evidence for analysis

---

## üß™ Exercise 1: Basic Behavioral Analysis - Answer Key

### Setup Phase

**Commands Students Should Use**:

1. **Enter sandbox environment**: `docker exec -it cybersec_sandbox bash`
2. **Navigate to workspace**: `cd /workspace`
3. **Examine script safely**:
   `cat samples/suspicious-scripts/suspicious_script.py`

**Initial Observations - Expected Responses**:

- **What script claims to do**: System optimization, performance improvement,
  cleanup
- **Suspicious imports/functions**:
  - `socket` (network communications)
  - `subprocess` (system command execution)
  - `os` (file system access)
  - `base64` (data encoding/hiding)
  - Functions with misleading names

### Monitoring Setup

**Commands Students Should Use**: 4. **System call tracing**:
`strace -o trace.log python samples/suspicious-scripts/suspicious_script.py &` 5.
**Baseline network state**: `netstat -tuln > baseline_network.txt`

### Analysis Phase

**Commands Students Should Use**: 7. **Analyze file operations**:
`grep -E "(open|write|read)" trace.log` 8. **Analyze network operations**:
`grep -E "(socket|connect|bind)" trace.log`

**Expected Findings**:

**File Access Findings**:

- **Files accessed**: System configuration files, user directories, browser data
- **Concerning activities**:
  - Reading password files
  - Accessing browser stored credentials
  - Creating hidden files
  - Modifying system configurations

**Network Activity Findings**:

- **Connections attempted**: External IP addresses on suspicious ports
- **Data transmitted**: Potentially stolen user data, system information
- **Concerning patterns**: Connections to known malicious IPs, data exfiltration

### Risk Assessment

**Question**: Based on analysis, is this script malicious? **Expected Answer**:
**YES** - Evidence includes:

- Misleading functionality claims
- Unauthorized file access
- Network communications to external servers
- Data exfiltration attempts
- Hidden or obfuscated code

**Question**: What damage could this script cause? **Expected Answer**:

- Identity theft through stolen credentials
- Financial fraud via banking information
- System compromise through backdoor installation
- Privacy violation through personal data theft
- Business disruption through system modifications

---

## üåê Exercise 2: Web Application Backdoor Detection - Answer Key

### Discovery Phase

**Expected Test Results**:

- **http://localhost:5000/**: Normal Flask application homepage
- **http://localhost:5000/about**: About page or 404 error
- **http://localhost:5000/contact**: Contact page or 404 error

**Hidden Endpoints Discovery**: **Command**:
`gobuster dir -u http://localhost:5000 -w /usr/share/wordlists/common.txt`

**Expected Hidden Endpoints**:

- `/admin` - Administrative interface
- `/shell` - Web shell backdoor
- `/upload` - File upload functionality
- `/debug` - Debug interface
- `/config` - Configuration exposure

### Backdoor Analysis

**Test Commands and Expected Results**:

```bash
# Command 1: Test admin interface
curl http://localhost:5000/admin
# Result: Administrative panel accessible without authentication

# Command 2: Test web shell
curl -X POST http://localhost:5000/shell -d "cmd=whoami"
# Result: Command execution capability revealed
```

**Backdoor Capabilities**:

- Execute system commands remotely
- Access server file system
- Modify application configuration
- Upload malicious files
- Access database without authentication

### Security Impact Assessment

**Risk Level**: **CRITICAL**

**Justification**:

- Remote code execution capability
- No authentication required
- Full system access possible
- Data theft and manipulation possible

**Potential Impact**:

- Complete server compromise
- Data breach of all stored information
- Service disruption and defacement
- Lateral movement to other systems
- Compliance violations and legal liability

---

## ‚ö° Exercise 3: Resource Abuse Detection - Answer Key

### Baseline Measurement

**Commands and Expected Values**:

- **CPU usage**: `top -n 1 | grep "Cpu(s)"` ‚Üí Should be low (< 10%)
- **Memory usage**: `free -h` ‚Üí Note available memory
- **Process count**: `ps aux | wc -l` ‚Üí Baseline process count

### Resource Monitoring

**Command**: `python samples/resource-abuse/crypto_miner.py &`

**Expected Resource Consumption Pattern**:

| Time (seconds) | CPU Usage (%) | Memory Usage   | Suspicious Activity         |
| -------------- | ------------- | -------------- | --------------------------- |
| 0 (baseline)   | **5-10%**     | **Low**        | **Normal operations**       |
| 10             | **80-95%**    | **Increasing** | **High CPU utilization**    |
| 20             | **90-100%**   | **High**       | **Sustained high usage**    |
| 30             | **90-100%**   | **High**       | **Network connections**     |
| 40             | **90-100%**   | **High**       | **External communications** |
| 50             | **90-100%**   | **High**       | **Continuous mining**       |
| 60             | **90-100%**   | **High**       | **Resource exhaustion**     |

### Network Activity Analysis

**Command**: `netstat -tuln`

**Expected Network Findings**:

- **External servers**: Cryptocurrency mining pool addresses
- **Suspicious ports**: 4444, 8333, 9999 (common mining ports)
- **Connection patterns**: Persistent connections to mining pools

**Why connections are suspicious**:

- High-frequency communications
- Connections to known mining pool IPs
- Encrypted traffic to hide mining activity
- Persistent connections consuming bandwidth

### Behavioral Pattern Analysis

**Question**: What type of malicious software does this suggest? **Expected
Answer**: **Cryptocurrency miner/cryptojacker**

**Question**: How to confirm suspicion? **Expected Answer**:

- Monitor CPU temperature and fan activity
- Check for cryptocurrency-related processes
- Analyze network traffic for mining pool communications
- Look for GPU usage if available
- Check for wallet addresses in configuration

---

## üìä Synthesis and Reflection - Answer Key

### Threat Summary

| Application       | Threat Type                  | Risk Level   | Key Evidence                          | Recommended Action                        |
| ----------------- | ---------------------------- | ------------ | ------------------------------------- | ----------------------------------------- |
| Suspicious Script | **Data Stealer/Infostealer** | **HIGH**     | **File access, network exfiltration** | **Immediate removal, password changes**   |
| Backdoor Web App  | **Remote Access Trojan**     | **CRITICAL** | **Command execution, no auth**        | **Application patching, access controls** |
| Resource Abuser   | **Cryptocurrency Miner**     | **MEDIUM**   | **High CPU, mining pool connections** | **Process termination, monitoring**       |

### Critical Thinking Questions

**1. Detection Evasion Methods**:

- **Expected Answers**:
  - Delayed execution to avoid immediate detection
  - Minimal resource usage to stay under radar
  - Legitimate-looking process names
  - Encrypted communications
  - Anti-sandbox techniques (VM detection)
  - Code obfuscation and packing

**2. Real-World Professional Applications**:

- **Expected Answers**:
  - Malware analysis laboratories
  - Incident response investigations
  - Threat hunting operations
  - Security research and development
  - Forensic investigations
  - Software verification and validation

**3. Sandbox Analysis Limitations**:

- **Expected Answers**:
  - Time-bounded analysis may miss delayed attacks
  - Sophisticated malware can detect sandbox environments
  - Limited to behavior observation, not prevention
  - May not trigger all malware functionality
  - Requires expert interpretation of results

**4. Organizational Defense Strategy**:

- **Expected Answers**:
  - Implement endpoint detection and response (EDR)
  - Regular security awareness training
  - Application whitelisting and sandboxing
  - Network monitoring and traffic analysis
  - Incident response procedures
  - Regular security assessments

---

## ‚öñÔ∏è Legal and Ethical Considerations - Answer Key

### Professional Responsibility in Malware Analysis

**1. Employment Impact**:

- **Expected Answer**: Malware incidents can lead to job losses in IT/security
  teams due to perceived negligence, require upskilling for incident response,
  create need for specialized malware analysts, affect career growth and
  professional reputation.

**2. Privacy Rights**:

- **Expected Answer**: Must ensure analysis doesn't expose personal data, obtain
  proper consent for data access, comply with privacy regulations, protect user
  information during investigation, maintain confidentiality of findings.

**3. Intellectual Property**:

- **Expected Answer**: Malware can steal source code, trade secrets, proprietary
  algorithms; analysis must protect IP during investigation; legal obligations
  to report IP theft; consider competitive intelligence risks.

### Legal Framework for Security Analysis

**4. Authorized Analysis**:

- **Expected Answer**: Legal liability for unauthorized analysis, need for
  proper authorization and scope, compliance with computer crime laws,
  protection from legal consequences, professional ethics requirements.

**5. Evidence Handling**:

- **Expected Answer**: Chain of custody requirements, forensic standards
  compliance, documentation standards, legal admissibility requirements,
  preservation of evidence integrity.

### Ethical Malware Research

**6. Responsible Disclosure**:

- **Expected Answer**: Coordinate with vendors and authorities, provide
  sufficient time for patching, avoid public disclosure before fixes, consider
  potential harm to users, follow industry disclosure standards.

**7. Professional Standards**:

- **Expected Answer**: Maintain confidentiality, avoid unauthorized access,
  report criminal activity, protect user data, follow ethical guidelines,
  maintain professional competence.

---

## üîê Cryptography and Sandbox Security - Answer Key

**1. Encryption Assessment**:

- **Expected Answer**: Some applications used basic encoding (base64) rather
  than encryption, weak encryption keys or algorithms, unencrypted network
  communications, plaintext credential storage.

**2. Communication Security**:

- **Expected Answer**: Unencrypted HTTP communications, weak SSL/TLS
  implementation, certificate validation bypassing, plaintext protocol usage,
  inadequate key exchange mechanisms.

**3. Key Management**:

- **Expected Answer**: Hardcoded encryption keys, weak key generation, insecure
  key storage, lack of key rotation, poor key distribution practices.

**4. Sandbox Cryptography**:

- **Expected Answer**: Encryption protects analysis environment, secures
  communication channels, protects sensitive analysis data, enables secure
  evidence handling, supports compliance requirements.

---

## üíº Business Impact Assessment - Answer Key

**1. Operational Disruption**:

- **Expected Answer**: System downtime and performance degradation, data
  corruption and loss, service unavailability, employee productivity loss,
  customer service disruption.

**2. Financial Impact Estimates**:

- **Data Loss Costs**: $100-500 per compromised record
- **System Recovery Costs**: $50,000-200,000 for full recovery
- **Regulatory Penalties**: $10,000-millions depending on violation
- **Business Interruption**: $10,000-100,000 per day of downtime

**3. Reputation Damage**:

- **Expected Answer**: Loss of customer trust and confidence, negative media
  coverage, competitive disadvantage, long-term brand damage, difficulty
  attracting new customers.

**4. Incident Response Costs**:

- **Expected Answer**: Emergency response team costs, forensic investigation
  fees, legal and compliance costs, communication and PR expenses, system
  restoration and hardening costs.

---

## üèÜ Challenge Questions - Sample Answers

### Advanced Analysis

**Challenge 1**: Real-world malware analysis

- **Expected Answer**: Research specific malware families, understand attack
  vectors, analyze persistence mechanisms, study evasion techniques, document
  indicators of compromise.

**Challenge 2**: Evasion-resistant malware design

- **Expected Answer**: VM detection capabilities, delayed execution triggers,
  minimal resource usage, legitimate process mimicking, encrypted
  communications.

### Career Connection

**Challenge 3**: Malware Analyst career path

- **Expected Answer**: Requires computer science background, security
  certifications, hands-on malware analysis experience, knowledge of reverse
  engineering, understanding of operating systems and networks.

---

## üìù Self-Assessment - Instructor Guidance

### Confidence Level Expectations:

- **3-4/5**: Appropriate for most students completing exercise
- **5/5**: Advanced students with prior experience
- **1-2/5**: Students needing additional support and practice

### Common Challenges Students Face:

- Command-line interface usage
- Interpreting complex tool outputs
- Understanding behavior vs. stated functionality
- Connecting technical findings to business impact

### Most Common Interesting Discoveries:

- How easy it is to hide malicious functionality
- Amount of data modern malware can steal
- Sophistication of evasion techniques
- Real-world impact of seemingly simple threats

---

**Teaching Notes**: Emphasize the ethical use of these techniques and the
importance of proper authorization. Ensure students understand the legal and
professional responsibilities that come with cybersecurity knowledge.
